<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Escuela de Ventas - Pandero</title>
  <link rel="icon" type="image/png" href="https://www.pandero.com.pe/favicon.ico" />
  <style>
    /* Estilos Generales y de Login */
    body { font-family: Arial, sans-serif; background-color: #f0f0f0; color: #333; margin: 0; padding: 0; }
    header { background-color: 
#0047bb; color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
    header img { height: 40px; }
    .container { max-width: 600px; margin: auto; padding: 1rem; }
    h1, h2 { color: 
#0047bb; }
    button { background-color: 
#0047bb; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin: 5px 0; font-size: 1rem;}
    input, select { width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box; }
    .hidden { display: none; }
    a { color: 
#0047bb; text-decoration: underline; }

    /* Estilos de Retos */
    .reto-btn { width: 100%; padding: 1rem; margin: 0.5rem 0; }
    .reto-btn.disabled { background: gray !important; cursor: not-allowed; }
    .enviar { background: green; padding: 0.5rem 1rem; }
    .volver { margin-top: 1rem; background: #5A6B7A; }
    .insignia { text-align: center; }
    .insignia img {  width: 250px;
  max-width: 100%; }

#botonesRetos {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
}

#botonesRetos .reto-btn {
  width: 45%;
  min-width: 120px;
  padding: 10px;
  font-size: 16px;
}

  </style>
</head>
<body>
  <header>
  <div><strong>Escuela de Ventas</strong></div>
  <img src="./img/pandero.png" alt="Logo Pandero" style="height: 40px;" />
</header>


  <div class="container">
    <div id="vista-inicio">
      <h2>üåå Misi√≥n del Vendedor del Futuro</h2>
<p>
A√±o 2045. El mundo cambi√≥.<br>
Los algoritmos de <strong>SYLON</strong> dominan las decisiones de compra.  
Pero t√∫ no eres cualquier vendedor.  
Has sido elegido por el Comit√© del Futuro Comercial.<br><br>
<strong>Tu misi√≥n:</strong> Derrotar a SYLON. Recuperar la confianza. Reconectar con los sue√±os.<br>
Cada reto que completes ser√° una victoria contra el sistema fr√≠o e impersonal.<br><br>
¬øEst√°s listo para escribir tu historia?
</p>
      <button onclick="mostrarVista('vista-registro')">üìù Registrar a mi equipo</button>
      <button onclick="mostrarVista('vista-login')">üîê Ya estoy registrado</button>
    </div>

    <div id="vista-registro" class="hidden">
      <h2>Registro del equipo</h2>
      <input type="hidden" id="division" value="Casa" />
<p><strong>Divisi√≥n:</strong> Casa</p>
<!-- Mensaje espec√≠fico del registro -->
<div id="registroMensaje" style="
  display: none;
  color: #c00;
  margin-bottom: 10px;
  font-weight: bold;
"></div>

      <label>Nombre del equipo</label>
      <select id="equipo"><option value="">Selecciona</option><option>Halcones</option><option>Titanes</option><option>F√©nix</option><option>Centellas</option><option>Jaguares</option><option>Dragones</option></select>
      <label>DNI integrante 1</label><input id="dni1" maxlength="8" />
      <label>DNI integrante 2</label><input id="dni2" maxlength="8" />
      <label>DNI integrante 3</label><input id="dni3" maxlength="8" />
      <label>DNI integrante 4</label><input id="dni4" maxlength="8" />
      <button onclick="validarRegistro()">Registrar y Entrar</button>
      <button class="volver" onclick="mostrarVista('vista-inicio')">Volver</button>
      <p id="errorRegistro" style="color: red;"></p>
    </div>

    <div id="vista-login" class="hidden">
      <h2>Accede a tu equipo</h2>
      <input type="hidden" id="divisionLogin" value="Casa" /> 
<p><strong>Divisi√≥n:</strong> Casa</p>

      <label>Nombre del equipo</label>
      <select id="equipoLogin"><option value="">Selecciona</option><option>Halcones</option><option>Titanes</option><option>F√©nix</option><option>Centellas</option><option>Jaguares</option><option>Dragones</option></select>
	<label>Contrase√±a</label>
<input id="claveLogin" type="password" />

      <button onclick="validarIngreso()">Entrar</button>
      <button class="volver" onclick="mostrarVista('vista-inicio')">Volver</button>
      <p id="errorIngreso" style="color: red;"></p>
    </div>

	
    <div id="vista-retos" class="hidden">
      <h2>üìú Misiones contra SYLON</h2>
<p>Completa cada reto para desbloquear el poder de la Venta Humana y derrotar a SYLON.</p>

	<div id="barra-contenedor" style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
  	<div style="flex-grow: 1; background-color: #ccc; border-radius: 8px; height: 20px; overflow: hidden;">
    	<div id="barra-progreso" style="width: 0%; height: 100%; background-color: #4CAF50;"></div>
 	 </div>
 	 <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Five-pointed_star.svg/1200px-Five-pointed_star.svg.png" 
  	     alt="Estrella" style="width: 24px; height: 24px;" />
	</div>

      <div id="botonesRetos">
        <button class="reto-btn" data-reto="1" onclick="abrirReto(1)">Reto 1</button>
        <button class="reto-btn" data-reto="2" onclick="abrirReto(2)">Reto 2</button>
        <button class="reto-btn" data-reto="3" onclick="abrirReto(3)">Reto 3</button>
        <button class="reto-btn" data-reto="4" onclick="abrirReto(4)">Reto 4</button>
        <button class="reto-btn" data-reto="5" onclick="abrirReto(5)">Reto 5</button>
        <button class="reto-btn" data-reto="6" onclick="abrirReto(6)">Reto 6</button>
        <button class="reto-btn" data-reto="7" onclick="abrirReto(7)">Reto 7</button>
        <button class="reto-btn" data-reto="8" onclick="abrirReto(8)">Reto 8</button>
      </div>
      <button class="volver" onclick="mostrarVista('vista-inicio')">Salir</button>
    </div>

    <div id="vista-reto-detalle" class="hidden">
      <h2 id="tituloReto"></h2>
      <p id="descripcionReto"></p>
      	<p id="instruccionRecursos" style="font-style: italic; color: #555;"></p>

<h3>Recursos para completar el reto:</h3>
<div id="recursosReto"></div>

<p id="instruccionPlantilla" style="font-style: italic; color: #555;"></p>

<h3>Plantilla a completar:</h3>
<div id="plantillaReto"></div>
      <label>Pega aqu√≠ el enlace de tu entrega:</label>
      <input type="url" id="enlaceEntrega" placeholder="https://..." />
      <button class="enviar" onclick="enviarEntrega()">üì§ Enviar enlace</button>
      <button class="volver" onclick="mostrarVista('vista-retos')">Volver a Misiones</button>
    </div>

    <div id="vista-insignia" class="hidden insignia">
  <p>¬°Reto superado! ‚≠ê Has derrotado una parte del sistema de SYLON.</p>
  <img id="img-insignia" src="" alt="Insignia del reto">
</div>


<script>
  const URL_SCRIPT = "https://script.google.com/macros/s/AKfycby6BH8BeQQeHE2Ppx-W9lNXSCIu04Y9tO5Hq_G-Xejfb1XTs0ejDU_X-6goKxPx7xzHZA/exec";

  // Objeto para guardar los datos del equipo que inici√≥ sesi√≥n. ¬°Clave para la integraci√≥n!
  let equipoActual = { division: null, equipo: null };
  let retoActual = 0;

 const descripciones = {
  1: "üß† Desenmascarar a SYLON con conocimiento humano\n\nSYLON confunde a las personas con tecnicismos vac√≠os. Tu misi√≥n es recuperar la confianza del cliente explic√°ndole qu√© es Pandero y c√≥mo funciona.\nUsa el contrato y el sistema como tus armas",
  
  2: "üé≤ Hackea el algoritmo: entiende todas las caracter√≠sticas de los contratos.\n\nSYLON se aprovecha de los clientes que no entienden sobre su contrato.\nDesactiva la duda, activa la claridad.",
  
  3: "‚ù§Ô∏è Conectar con el miedo\n\nSYLON quiere que el cliente se sienta solo si deja de pagar.\nTu reto es explicar con empat√≠a qu√© ocurre en ese caso.\nNo vendas miedo: vende acompa√±amiento. Usa el contrato como escudo.",
  
  4: "üè† Una serie de registros ha llegado a tus manos. Voces, tonos, silencios... Debes entrenar tu percepci√≥n para detectar qu√© hace que una llamada triunfe (o fracase). Ser√°s observador y juez, mentor y aprendiz.",
  
  5: "üß© Romper la ‚ÄúIncertidumbre‚Äù\n\nSYLON ha programado a los humanos a ser temerosos.\nEl asociado ha iniciado su viaje, pero necesita tu gu√≠a. Tu deber es trazar el camino sin errores. Crear√°s un gui√≥n con una narrativa muy emp√°tica. Si lo haces bien, evitar√°s que se pierda en el camino.",
  
  6: "üì± El escenario ha cambiado. Las pantallas son vitrinas y los videos, vitrales. Es hora de crear contenido para ser visto, compartido y recordado. Cada seguidor es una semilla, cada like una puerta abierta.",
  
  7: "üí° La operaci√≥n final est√° aqu√≠.  El app es tu comando, el portal est√° activo. Ya conoces las herramientas, ahora debes usarlas en tiempo real. Demuestra que puedes cerrar un proceso con precisi√≥n y eficiencia.",
  
  8: "üè† Domina el mercado: crea tu cat√°logo de comparativa de precios de los departamentos seg√∫n distritos.\n\nSYLON cree que los vendedores repiten sin comprender. Tu misi√≥n es probar lo contrario.\nArma un cat√°logo visual con las comparativas por zonas.",

};

const recursos = {
  1: `
    <p>Revisa y estudia cuidadosamente el sistema y el contrato que se encuentran en estos enlaces.</p>
    <ul>
        <li><a href="https://star.pandero.com.pe/course/view.php?id=148" target="_blank">Sistema Pandero</a></li>
        <li><a href="docs/Contrato_sin_Valor_C5.pdf" target="_blank">Contrato C5</a></li>
	      <li><a href="docs/Contrato_sin_valor_C9.pdf" target="_blank">Contrato C9</a></li>
    </ul>
  `,
  2: `
    <p>Escucha el audio completo para entender m√°s sobre el tipo de contratos, toma nota de los puntos importantes, lo necesitar√°s para derrotar a las fuerzas oscuras de Sylon</p>
    <audio controls style="width: 100%;">
      <source src="audios/reto2.mp3" type="audio/mpeg">
      Tu navegador no soporta audio.
    </audio>
  `,
  3: `<p>Elabora y adapta un discurso comercial para darle seguridad al cliente (escribe un gui√≥n). Graba un video y compartelo por el grupo de whatsapp.</p>
    <ul>
        <li><a href="docs/Contrato_sin_Valor_C5.pdf" target="_blank">Contrato C5</a></li>
	      <li><a href="docs/Contrato_sin_valor_C9.pdf" target="_blank">Contrato C9</a></li>
    </ul>
`
,
  4: `<p>Escucha dos ventas: una falla, otra brilla. Analiza bien... y ay√∫danos a vencer a SYLON con lo que aprendas.</p>
	<p>Caso 1:</p>
    <audio controls style="width: 100%;">
      <source src="audios/caso1.mp3" type="audio/mpeg">
      Tu navegador no soporta audio.
    </audio>
	<p>Caso 2:</p>
    <audio controls style="width: 100%;">
      <source src="audios/caso2.mp3" type="audio/mpeg">
      Tu navegador no soporta audio.
    </audio>
`,
  5: `<p>Revisa y estudia cuidadosamente el proceso de tramitaci√≥n, crea un gui√≥n y graba un video. Luego comparte el video por el grupo de Whatsapp</p>
    <ul>
        <li><a href="docs/3_Tramitaci√≥n_del_inmueble.pdf" target="_blank">Tramitaci√≥n</a></li>
    </ul>
`,
  6: `<p>Lee la siguiente presentaci√≥n y utilizalo para inspirarte. Vence a SYLON con el poder de las redes sociales. Postea tu video en Instagram o Tiktok y luego copia el enlace.</p>
<ul>
        <li><a href="docs/4_Manual_de_Ventas_Casa.pdf" target="_blank">Manual de ventas</a></li>
    </ul>`,
  7: `<p>El app es tu comando, el portal est√° activo. Ya conoces las herramientas, ahora debes usarlas en tiempo real. Demuestra que puedes cerrar un proceso con precisi√≥n y eficiencia.</p>
<ul>
        <li><a href="docs/6_App_de_ventas_2025.pdf" target="_blank">App de ventas</a></li>
    </ul>`,
  8: `<p>El reto final est√° aqu√≠. Crea un cat√°logo visual con la informaci√≥n de los bienes seg√∫n la zona, incluyendo im√°genes y descripciones.</p>`,
};

const plantillas = {
  1: `<p>Ingresa al enlace, reg√≠strate y completa los datos para que puedas vencer a Sylon. Cuando termines de completar todos los campos copia el enlace en modo p√∫blico.</p>
      <ul>
        <li><a href="https://www.canva.com/design/DAGu_nX9jbI/Cix1HTgidL-oOitIat8HNA/view?utm_content=DAGu_nX9jbI&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink&mode=preview" target="_blank">Plantilla en Canva</a></li>
      </ul>`,
  2: `<p>Ingresa al enlace y completa el recuadro para que puedas vencer a Sylon. Cuando termines de completar todos los campos copia el enlace en modo p√∫blico.</p>
      <ul>
        <li><a href="https://www.canva.com/design/DAGu_nGSpss/_SRR6-AFtUeyMThlE0GM7A/view?utm_content=DAGu_nGSpss&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink&mode=preview" target="_blank">Comparativo casa</a></li>
      </ul>`,
  3: `<p>Este reto no tiene plantilla‚Ä¶ porque t√∫ eres quien debe crearla. ¬øSer√°s capaz de improvisar sin una gu√≠a? La decisi√≥n (y la gloria) es toda tuya.</p>`,
4: `<p>Ingresa al enlace y completa el recuadro para que puedas vencer a Sylon. Cuando termines de completar todos los campos copia el enlace en modo p√∫blico.</p>
<ul>
        <li><a href="https://www.canva.com/design/DAGu_uHL9I0/qEefNMyw6wTli9d7W9Qfeg/view?utm_content=DAGu_uHL9I0&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink&mode=preview" target="_blank">Plantilla en Canva</a></li>
      </ul>`,
5: `<p>Ingresa al enlace y crea el gui√≥n. ¬øCrees que puedas vencer a SYLON?</p>
<ul>
        <li><a href="https://www.canva.com/design/DAGu_HuotnA/hebKM4K2Mu-Vekhw1_WDSQ/view?utm_content=DAGu_HuotnA&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink&mode=preview" target="_blank">Plantilla en Canva</a></li>
      </ul>`,
6: `<p>Este reto no tiene plantilla‚Ä¶ porque t√∫ eres quien debe crearla. ¬øSer√°s capaz de improvisar sin una gu√≠a? La decisi√≥n (y la gloria) es toda tuya.</p>`,
7: `<p>Ingresa al enlace y sube las capturas de pantallas del app y correo para que puedas vencer a Sylon. Cuando termines de realizarlo copia el enlace en modo p√∫blico.</p>
<ul>
        <li><a href="https://www.canva.com/design/DAGu_CP81Gc/DGkWcZFlI3zw2LcmncnFyg/view?utm_content=DAGu_CP81Gc&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink&mode=preview" target="_blank">Plantilla en Canva</a></li>
      </ul>`,
8: `<p>Puedes utilizar esta plantilla o crear tu propio modelo. Es el reto final, puedes mostrarle a SYLON todas tus armas y termina con su legado del mal.</p>
<ul>
        <li><a href="https://www.canva.com/design/DAGu_Fg83mY/D071hyIr7cZxPBxysIQmdg/view?utm_content=DAGu_Fg83mY&utm_campaign=designshare&utm_medium=link&utm_source=publishsharelink&mode=preview" target="_blank">Plantilla en Canva</a></li>
      </ul>`,
};

   const insignias = {
    1: "./img/Insignia1.png",
    2: "./img/Insignia2.png",
    3: "./img/Insignia3.png",
    4: "./img/Insignia4.png",
    5: "./img/Insignia5.png",
    6: "./img/Insignia6.png",
    7: "./img/Insignia7.png",
    8: "./img/Insignia8.png"
  };


  // --- FUNCI√ìN CENTRAL PARA NAVEGAR ---
  function mostrarVista(idVista) {
    const vistas = document.querySelectorAll('.container > div');
    vistas.forEach(vista => vista.classList.add('hidden'));
    document.getElementById(idVista).classList.remove('hidden');
  }
  
  window.onload = () => mostrarVista('vista-inicio');

  // --- FUNCIONES DE LOGIN Y REGISTRO ---
  async function validarRegistro() {
    const boton = event.target;
    desactivarBotonTemporalmente(boton);
    
    const division = document.getElementById("division").value;
    const equipo = document.getElementById("equipo").value;
    const dni1 = document.getElementById("dni1").value.padStart(8, '0');
    const dni2 = document.getElementById("dni2").value.padStart(8, '0');
    const dni3 = document.getElementById("dni3").value.padStart(8, '0');
    const dni4 = document.getElementById("dni4").value.padStart(8, '0');
    
    const errorP = document.getElementById("errorRegistro");

    if (!division || !equipo) {
      errorP.textContent = "Completa tu equipo.";
      return;
    }
    
// 1) Pregunto si ya existe hoy este equipo:
const resCheck = await fetch(
  `${URL_SCRIPT}?tipo=validarRegistro` +
  `&division=${encodeURIComponent(division)}` +
  `&equipo=${encodeURIComponent(equipo)}`
);

const dataCheck = await resCheck.json();

if (dataCheck.existe) {
  const msg = document.getElementById("registroMensaje");
  msg.textContent = `‚ö†Ô∏è El equipo "${equipo}" ya fue registrado hoy.`;
  msg.style.display = "block";
  return;
}

// 2) Si no existe, contin√∫a aqu√≠ con tu fetch POST para guardar el equipo

    
    const payload = { tipo: "registro", division, equipo, dni1, dni2, dni3, dni4 };

    try {
      const res = await fetch(URL_SCRIPT, { method: "POST", headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(payload) });
      const data = await res.json();
      if (data.status === "success") {
        equipoActual = { division, equipo }; // Guarda los datos del equipo
        mostrarVista('vista-retos');
setTimeout(() => {
  obtenerRetosCompletados(equipoActual.division, equipoActual.equipo);
}, 10); // Espera 10 milisegundos


      } else {
        errorP.textContent = `Error: ${data.message}`;
      }
    } catch (err) {
      errorP.textContent = "Error de conexi√≥n.";
    }
  }

  async function validarIngreso() {
    const division = document.getElementById("divisionLogin").value;
    const equipo = document.getElementById("equipoLogin").value;
    const clave = document.getElementById("claveLogin").value;
    const errorP = document.getElementById("errorIngreso");

    if (!division || !equipo || !clave) {
      errorP.textContent = "Completa todos los campos.";
      return;
    }
    const payload = { tipo: "login", division, equipo, clave };

    try {
      const res = await fetch(URL_SCRIPT, { method: "POST", headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(payload) });
      const data = await res.json();
      if (data.status === "success") {
        equipoActual = { division, equipo }; // Guarda los datos del equipo
        mostrarVista('vista-retos');
        setTimeout(() => {
        obtenerRetosCompletados(equipoActual.division, equipoActual.equipo);
      }, 10); // Espera 10 milisegundos


      } else {
        errorP.textContent = `‚ö†Ô∏è ${data.message}`;
      }
    } catch (err) {
      errorP.textContent = "Error de conexi√≥n.";
    }
  }

  // --- FUNCIONES DE RETOS (ADAPTADAS) ---
 function abrirReto(n) {
  retoActual = n;

  document.getElementById("tituloReto").textContent          = "Reto " + n;
  document.getElementById("descripcionReto").textContent     = descripciones[n]           || "";
  //document.getElementById("instruccionRecursos").textContent = instruccionesRecursos[n]   || "";
  document.getElementById("recursosReto").innerHTML          = recursos[n]                || "<p>No hay recursos a√∫n.</p>";
  //document.getElementById("instruccionPlantilla").textContent= instruccionesPlantilla[n]  || "";
  document.getElementById("plantillaReto").innerHTML         = plantillas[n]              || "<p>No hay plantilla a√∫n.</p>";
  document.getElementById("enlaceEntrega").value = "";
  mostrarVista('vista-reto-detalle');
}

  async function enviarEntrega() {
    const boton = event.target;
    desactivarBotonTemporalmente(boton);

    const enlace = document.getElementById("enlaceEntrega").value.trim();
    if (!enlace) {
      alert("Debes ingresar un enlace v√°lido.");
      return;
    }

    // Usa los datos guardados en `equipoActual`
    const payload = {
      tipo: "entrega",
      division: equipoActual.division,
      equipo: equipoActual.equipo,
      reto: "Reto " + retoActual,
      enlace
    };

    try {
      const res = await fetch(URL_SCRIPT, { method: "POST", headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(payload) });
      const data = await res.json();
      if (data.status === "success") {
        const insigniaImg = document.getElementById("img-insignia");
if (insigniaImg && insignias[retoActual]) {
  insigniaImg.src = insignias[retoActual];
}
mostrarVista('vista-insignia');

        
        // Deshabilita el bot√≥n del reto completado
        const btns = document.querySelectorAll("#botonesRetos .reto-btn");
        if (btns[retoActual - 1]) {
          btns[retoActual - 1].classList.add("disabled");
        }

        setTimeout(() => {
        mostrarVista('vista-retos');
        obtenerRetosCompletados(); // <-- actualiza los botones grises y la barra
        }, 5000);
      } else {
        alert("Error al guardar la entrega.");
      }
    } catch (err) {
      alert("Error de conexi√≥n.");
    }
  }
async function obtenerRetosCompletados() {
  const { division, equipo } = equipoActual;

  try {
    const res = await fetch(`${URL_SCRIPT}?tipo=retosCompletados&division=${division}&equipo=${equipo}`);
    const data = await res.json();

    if (Array.isArray(data.retos)) {
      const btns = document.querySelectorAll("#botonesRetos .reto-btn");
      data.retos.forEach(num => {
        const btn = btns[num - 1];
        if (btn) {
          btn.classList.add("disabled");
        }
      });
	const barra = document.getElementById("barra-progreso");
      if (barra) {
        const total = btns.length;
        const completados = data.retos.length;
        const porcentaje = (completados / total) * 100;
        barra.style.width = `${porcentaje}%`;
      }
    }
  } catch (err) {
    console.error("No se pudieron cargar los retos completados", err);
  }
}

function desactivarBotonTemporalmente(boton, tiempo = 10000) { // Para evitar que dupliquen env√≠os
  boton.disabled = true;
  boton.style.opacity = "0.6";
  boton.style.cursor = "not-allowed";
  setTimeout(() => {
    boton.disabled = false;
    boton.style.opacity = "1";
    boton.style.cursor = "pointer";
  }, tiempo);
}
</script>
</body>
</html>

</script>
</body>

</html>

